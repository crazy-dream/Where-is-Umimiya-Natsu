<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>çŒœçŒœå°ä¸‘åœ¨å“ªè£¡</title>

<style>
:root{
  --bg:#bfe8ff;
  --door:#3aa0ff;
  --accent:#ff4b6e;
  --text:#002d59;
  --red:#ff3b3b;
  --win:#1E90FF;
}
html,body{height:100%; margin:0; font-family:"Microsoft JhengHei",sans-serif; background:var(--bg);}
.fullscreen-story{
  position:fixed;
  inset:0;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:99999;
  flex-direction:row;
  overflow:hidden;
}
.story-img{
  width:100%;
  height:100%;
  object-fit:cover;
  flex-shrink:0;
}
.story-text{
  position:absolute;
  right:20px;
  top:50%;
  transform:translateY(-50%);
  color:black;
  font-size:24px;
  writing-mode: vertical-rl;
  cursor:pointer;
  z-index:100000;
}
</style>
</head>
<body>

<div id="storyContainer" class="fullscreen-story">
  <img id="storyImg" class="story-img">
  <div class="story-text">é»æ“Šä»»æ„åœ°æ–¹ç¹¼çºŒ</div>
</div>

<div class="game-wrap" style="display:none">
  <header>
    <div class="level-badge" id="levelBadge">ç¬¬1é—œ</div>
    <h1>çŒœçŒœå°ä¸‘åœ¨å“ªè£¡</h1>
    <div class="lives">
      <div class="life" id="life1"></div>
      <div class="life" id="life2"></div>
      <div class="life" id="life3"></div>
    </div>
  </header>

  <div class="stage">
    <div class="door-card" id="doorA">
      <div class="reveal-area"><img id="imgA" class="reveal-img"></div>
      <div class="panel left">ğŸ¤¡</div>
      <div class="panel right">ğŸ¤¡</div>
    </div>
    <div class="door-card" id="doorB">
      <div class="reveal-area"><img id="imgB" class="reveal-img"></div>
      <div class="panel left">ğŸ¤¡</div>
      <div class="panel right">ğŸ¤¡</div>
    </div>
  </div>
</div>

<div class="overlay" id="overlay">
  <div class="overlay-message" id="overlayMsg">GAME OVER</div>
</div>

<script>
const storyImgs = [
  "story/æ´‹èŠ‹ç‰‡1.jpg",
  "story/æ´‹èŠ‹ç‰‡2.jpg",
  "story/æ´‹èŠ‹ç‰‡3.jpg",
  "story/æ´‹èŠ‹ç‰‡4.jpg",
  "story/æ´‹èŠ‹ç‰‡5.jpg",
  "story/æ´‹èŠ‹ç‰‡6.jpg"
];
let storyIndex = 0;
const storyContainer = document.getElementById("storyContainer");
const storyImg = document.getElementById("storyImg");

function showNextStory() {
  if(storyIndex >= storyImgs.length){
    storyContainer.style.display = "none";
    document.querySelector(".game-wrap").style.display = "flex";
    return;
  }
  storyImg.src = storyImgs[storyIndex];
  storyIndex++;
}

storyContainer.onclick = showNextStory;

// åˆå§‹åŒ–ç¬¬ä¸€å¼µ
showNextStory();
</script>

<!-- åŸéŠæˆ²ç¨‹å¼ç¢¼ä¿æŒä¸è®Š -->
<script>
let level=1,lives=3,jokerSide="A",lock=false;

const JOKER_IMAGES=[
  "joker/1.png","joker/1000018658.jpeg","joker/1000018659.jpeg","joker/2.png",
  "joker/3.png","joker/4 (2).png","joker/4.png","joker/5.png",
  "joker/546175134_1138063744950693_180659281319095751_n.jpg",
  "joker/Am I (1).jpg","joker/Am I (2).jpg","joker/Am I (3).jpg","joker/Am I (4).jpg",
  "joker/Am I.jpg","joker/I am joker. (1).jpg","joker/I am joker. (2).jpg",
  "joker/I am joker. (3).jpg","joker/I am joker. çš„è¤‡æœ¬ (1).jpg",
  "joker/I am joker..jpg","joker/I am joker..png",
  "joker/IMG_20250806_193336_118.jpg","joker/IMG_20251001_224237_440-removebg-preview.png",
  "joker/IMG_20251118_213550_407.jpg",
  "joker/unnamed (1).webp","joker/unnamed (2).webp","joker/unnamed (4).webp","joker/unnamed.webp",
  "joker/æœªå‘½åè¨­è¨ˆ.jpg","joker/æœªå‘½åè¨­è¨ˆ.png",
  "joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 231537.png",
  "joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 231953.png","joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 232248.png",
  "joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 232410.png","joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 232433.png",
  "joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 232449.png","joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 233008.png"
];
const FILLER_IMAGES=["wrong/Ri86b7h.jpg"];

const doorA=document.getElementById("doorA");
const doorB=document.getElementById("doorB");
const imgA=document.getElementById("imgA");
const imgB=document.getElementById("imgB");
const overlay=document.getElementById("overlay");
const overlayMsg=document.getElementById("overlayMsg");

function updateLives(){
  for(let i=1;i<=3;i++){
    const el=document.getElementById("life"+i);
    if(i<=lives) el.classList.remove("empty");
    else el.classList.add("empty");
  }
}

function preloadImage(src){
  return new Promise(resolve=>{
    const img=new Image();
    img.onload=()=>resolve(src);
    img.src=src;
  });
}

let nextImages={A:'',B:''};
async function setRandomImages(){
  jokerSide=Math.random()<0.5?"A":"B";
  const jokerImg=JOKER_IMAGES[Math.floor(Math.random()*JOKER_IMAGES.length)];
  const fillerImg=FILLER_IMAGES[0];

  if(jokerSide==="A"){ nextImages={A:jokerImg,B:fillerImg}; }
  else{ nextImages={A:fillerImg,B:jokerImg}; }

  await Promise.all([preloadImage(nextImages.A),preloadImage(nextImages.B)]);
  imgA.src=nextImages.A;
  imgB.src=nextImages.B;
}

function playCorrectEffect(){
  const pop=document.createElement("div");
  pop.className="pop-clown";
  pop.textContent="ğŸ¤¡";
  document.body.appendChild(pop);
  setTimeout(()=>pop.remove(),900);
}

function playWrongEffect(door){
  door.classList.add("shake");
  setTimeout(()=>door.classList.remove("shake"),400);
}

function showGameOver(){
  overlay.classList.add("show");
  overlayMsg.textContent="GAME OVER";
  overlayMsg.style.color="red";
}

function showWin(){
  overlay.classList.add("show");
  overlayMsg.textContent="WIN";
  overlayMsg.style.color="var(--win)";
}

function clickDoor(side){
  if(lock) return;
  lock=true;

  const door=side==="A"?doorA:doorB;
  const correct=(side===jokerSide);

  door.classList.add("open");

  if(correct){
    playCorrectEffect();
  }else{
    playWrongEffect(door);
  }

  setTimeout(()=>{
    door.classList.remove("open");

    setTimeout(async()=>{
      if(!correct){
        lives--;
        updateLives();
        if(lives<=0){ showGameOver(); return; }
      }

      level++;
      if(level>6){ showWin(); return; }

      document.getElementById("levelBadge").textContent=`ç¬¬${level}é—œ`;
      await setRandomImages();
      lock=false;
    },750);

  },800);
}

doorA.onclick=()=>clickDoor("A");
doorB.onclick=()=>clickDoor("B");

updateLives();
setRandomImages();
</script>

</body>
</html>
