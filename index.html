<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>çŒœçŒœå°ä¸‘åœ¨å“ªè£¡</title>

<style>
:root{
  --bg:#bfe8ff;
  --door:#3aa0ff;
  --accent:#ff4b6e;
  --text:#002d59;
  --red:#ff3b3b;
  --win:#1E90FF;
}

html, body{
  height:100%;
  margin:0;
  font-family:"Microsoft JhengHei",sans-serif;
  background:var(--bg);
  overflow:hidden;
}

#storyPlayer{
  position:fixed;
  inset:0;
  background:black;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:99999;
  flex-direction:column;
  overflow:hidden;
}

#storyImg{
  width:100%;
  height:100%;
  object-fit:cover;
  background:black;
}

#storyHint{
  position:absolute;
  right:20px;
  top:50%;
  transform:translateY(-50%);
  writing-mode:vertical-rl;
  font-size:28px;
  letter-spacing:4px;
  opacity:0.8;
}

.game-wrap{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:28px;
  gap:18px;

  position:fixed;
  inset:0;
  overflow:hidden;
}

header{
  width:100%;
  display:flex;
  justify-content:center;
  position:relative;
}
h1{margin:0;font-size:28px;}
.level-badge{
  position:absolute;
  left:18px;
  top:0;
  padding:6px 10px;
  border-radius:10px;
  font-weight:700;
  background:rgba(255,255,255,0.25);
  backdrop-filter: blur(4px);
}

.lives{
  position:absolute;
  right:18px;
  top:0;
  display:flex;
  gap:8px;
}
.life{
  width:18px;
  height:18px;
  border-radius:50%;
  background:var(--red);
}
.life.empty{
  background:#eee;
  border:1px solid #aaa;
}

.stage{
  display:flex;
  gap:32px;
  justify-content:center;
  margin-top:20px;
}

.door-card{
  width:540px; height:420px;
  background:var(--door);
  border-radius:16px;
  position:relative;
  overflow:hidden;
  cursor:pointer;
  transition:0.2s;
}
@keyframes shake {
  0%{ transform:translateX(0);}
  20%{ transform:translateX(-12px);}
  40%{ transform:translateX(12px);}
  60%{ transform:translateX(-8px);}
  80%{ transform:translateX(8px);}
  100%{ transform:translateX(0);}
}
.shake{ animation:shake 0.4s ease; }

.reveal-area{
  position:absolute;
  inset:0;
  z-index:1;
  display:flex;
  justify-content:center;
  align-items:center;
}
.reveal-img{
  max-width:100%;
  max-height:100%;
  object-fit:cover;
}

.panel{
  position:absolute;
  z-index:10;
  width:50%;
  top:0;
  bottom:0;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:60px;
  font-weight:900;
  background:var(--door);
  transition:0.75s;
}
.panel.left{ left:0; }
.panel.right{ right:0; }
.door-card.open .panel.left{ transform:translateX(-100%); }
.door-card.open .panel.right{ transform:translateX(100%); }

.pop-clown{
  position:fixed;
  left:50%; top:50%;
  transform:translate(-50%,-50%) scale(0.1);
  font-size:40px;
  opacity:0.2;
  z-index:9999;
  animation:pop 0.9s ease-out forwards;
}
@keyframes pop {
  0% { transform:translate(-50%,-50%) scale(0.1); opacity:0; }
  40%{ transform:translate(-50%,-50%) scale(3.0); opacity:0.7; }
  100%{ transform:translate(-50%,-50%) scale(4.0); opacity:0; }
}

.overlay{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,0);
  pointer-events:none;
  z-index:999;
  transition:0.3s;

  overflow:hidden;
}
.overlay-message{
  opacity:0;
  font-size:70px;
  font-weight:900;
  color:red;
  transition:0.3s;
}
.overlay.show{background:rgba(0,0,0,0.65); pointer-events:auto;}
.overlay.show .overlay-message{opacity:1;}
</style>
</head>

<body>

<div id="storyPlayer">
  <img id="storyImg">
  <div id="storyHint">é»æ“Šä»»æ„åœ°æ–¹ç¹¼çºŒ</div>
</div>

<div class="game-wrap" id="gameArea" style="display:none;">
  <header>
    <div class="level-badge" id="levelBadge">ç¬¬1é—œ</div>
    <h1>çŒœçŒœå°ä¸‘åœ¨å“ªè£¡</h1>
    <div class="lives">
      <div class="life" id="life1"></div>
      <div class="life" id="life2"></div>
      <div class="life" id="life3"></div>
    </div>
  </header>

  <div class="stage">
    <div class="door-card" id="doorA">
      <div class="reveal-area"><img id="imgA" class="reveal-img"></div>
      <div class="panel left">ğŸ¤¡</div>
      <div class="panel right">ğŸ¤¡</div>
    </div>
    <div class="door-card" id="doorB">
      <div class="reveal-area"><img id="imgB" class="reveal-img"></div>
      <div class="panel left">ğŸ¤¡</div>
      <div class="panel right">ğŸ¤¡</div>
    </div>
  </div>
</div>

<div class="overlay" id="overlay">
  <div class="overlay-message" id="overlayMsg">GAME OVER</div>
</div>

<script>

const introStory = [
  "story/æ´‹èŠ‹ç‰‡1.jpg",
  "story/æ´‹èŠ‹ç‰‡2.jpg",
  "story/æ´‹èŠ‹ç‰‡3.jpg",
  "story/æ´‹èŠ‹ç‰‡4.jpg",
  "story/æ´‹èŠ‹ç‰‡5.jpg",
  "story/æ´‹èŠ‹ç‰‡6.jpg"
];

const gameOverStory = [
  "story/æ´‹èŠ‹ç‰‡7.jpg",
  "story/æ´‹èŠ‹ç‰‡8.jpg",
  "story/æ´‹èŠ‹ç‰‡9.jpg"
];

const winStory = [
  "story/æ´‹èŠ‹ç‰‡8.jpg",
  "story/æ´‹èŠ‹ç‰‡9.jpg"
];

let storyIndex = 0;
let currentStory = introStory;
let storyMode = "intro";

const storyPlayer = document.getElementById("storyPlayer");
const storyImg = document.getElementById("storyImg");
const storyHint = document.getElementById("storyHint");

function playStory(list, mode){
  currentStory = list;
  storyMode = mode;
  storyIndex = 0;

  storyImg.src = currentStory[0];

  updateHint(currentStory[0]);

  storyPlayer.style.display = "flex";
}

function updateHint(imgSrc) {
  if (imgSrc.includes("æ´‹èŠ‹ç‰‡9")) {
    storyHint.textContent = "é»æ“Šä»»æ„åœ°æ–¹å†ä¸€æ¬¡";
    storyHint.style.color = "white";
  } else {
    storyHint.textContent = "é»æ“Šä»»æ„åœ°æ–¹ç¹¼çºŒ";
    storyHint.style.color = "black";
  }
}

storyPlayer.onclick = ()=>{
  storyIndex++;

  if(storyIndex >= currentStory.length){
    if(storyMode === "intro"){
      storyPlayer.style.display="none";
      document.getElementById("gameArea").style.display="flex";
    } else {
      location.reload();
    }
    return;
  }

  storyImg.src = currentStory[storyIndex];

  updateHint(currentStory[storyIndex]);
};

playStory(introStory, "intro");




let level=1,lives=3,jokerSide="A",lock=false;

const JOKER_IMAGES = [
  "joker/1.png","joker/1000018658.jpeg","joker/1000018659.jpeg","joker/2.png",
  "joker/3.png","joker/4 (2).png","joker/4.png","joker/5.png",
  "joker/546175134_1138063744950693_180659281319095751_n.jpg",
  "joker/Am I (1).jpg","joker/Am I (2).jpg","joker/Am I (3).jpg","joker/Am I (4).jpg",
  "joker/Am I.jpg","joker/I am joker. (1).jpg","joker/I am joker. (2).jpg",
  "joker/I am joker. (3).jpg","joker/I am joker. çš„è¤‡æœ¬ (1).jpg",
  "joker/I am joker..jpg","joker/I am joker..png",
  "joker/IMG_20250806_193336_118.jpg",
  "joker/IMG_20251001_224237_440-removebg-preview.png",
  "joker/IMG_20251118_213550_407.jpg",
  "joker/unnamed (1).webp","joker/unnamed (2).webp","joker/unnamed (4).webp","joker/unnamed.webp",
  "joker/æœªå‘½åè¨­è¨ˆ.jpg","joker/æœªå‘½åè¨­è¨ˆ.png",
  "joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 231537.png",
  "joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 231953.png","joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 232248.png",
  "joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 232410.png","joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 232433.png",
  "joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 232449.png","joker/è¢å¹•æ“·å–ç•«é¢ 2025-11-20 233008.png",
  "joker/IMG_20251129_183753_540.jpg",
  "joker/IMG_20251129_183804_371.jpg",
  "joker/IMG_20251129_183808_254.jpg",
  "joker/Screenshot_20251129_183328_Instagram.jpg",
  "joker/Screenshot_20251129_183506_Instagram.jpg",
  "joker/Screenshot_20251129_183517_Instagram.jpg",
  "joker/Screenshot_20251129_183522_Instagram.jpg"
];

const FILLER_IMAGES=["wrong/Ri86b7h.jpg"];

const doorA=document.getElementById("doorA");
const doorB=document.getElementById("doorB");
const imgA=document.getElementById("imgA");
const imgB=document.getElementById("imgB");
const overlay=document.getElementById("overlay");
const overlayMsg=document.getElementById("overlayMsg");

function updateLives(){
  for(let i=1;i<=3;i++){
    const el=document.getElementById("life"+i);
    if(i<=lives) el.classList.remove("empty");
    else el.classList.add("empty");
  }
}

function preloadImage(src){
  return new Promise(resolve=>{
    const img=new Image();
    img.onload=()=>resolve(src);
    img.src=src;
  });
}

let nextImages={A:'',B:''};
async function setRandomImages(){
  jokerSide=Math.random()<0.5?"A":"B";
  const jokerImg=JOKER_IMAGES[Math.floor(Math.random()*JOKER_IMAGES.length)];
  const fillerImg=FILLER_IMAGES[0];

  if(jokerSide==="A"){ nextImages={A:jokerImg,B:fillerImg}; }
  else{ nextImages={A:fillerImg,B:jokerImg}; }

  await Promise.all([preloadImage(nextImages.A),preloadImage(nextImages.B)]);
  imgA.src=nextImages.A;
  imgB.src=nextImages.B;
}

function playCorrectEffect(){
  const pop=document.createElement("div");
  pop.className="pop-clown";
  pop.textContent="ğŸ¤¡";
  document.body.appendChild(pop);
  setTimeout(()=>pop.remove(),900);
}

function playWrongEffect(door){
  door.classList.add("shake");
  setTimeout(()=>door.classList.remove("shake"),400);
}

function showGameOver(){
  overlay.classList.add("show");
  overlayMsg.textContent="GAME OVER";
  overlayMsg.style.color="red";

  setTimeout(()=>{
    playStory(gameOverStory,"gameover");
  },1200);
}

function showWin(){
  overlay.classList.add("show");
  overlayMsg.textContent="WIN";
  overlayMsg.style.color="var(--win)";

  setTimeout(()=>{
    playStory(winStory,"win");
  },1200);
}

function clickDoor(side){
  if(lock) return;
  lock=true;

  const door=side==="A"?doorA:doorB;
  const correct=(side===jokerSide);

  door.classList.add("open");

  if(correct){
    playCorrectEffect();
  }else{
    playWrongEffect(door);
  }

  setTimeout(()=>{
    door.classList.remove("open");

    setTimeout(async()=>{
      if(!correct){
        lives--;
        updateLives();
        if(lives<=0){ showGameOver(); return; }
      }

      level++;
      if(level>6){ showWin(); return; }

      document.getElementById("levelBadge").textContent=`ç¬¬${level}é—œ`;
      await setRandomImages();
      lock=false;
    },750);

  },800);
}

doorA.onclick=()=>clickDoor("A");
doorB.onclick=()=>clickDoor("B");

updateLives();
setRandomImages();
</script>

</body>
</html>
